---
title: "Статистический отчёт по результатам клинического исследования III фазы по изучению эффективности и безопасности Климаксана"
authors: "Беркович Ян, Гордеев Алексей, Смородина Жанна, Тимкина Наталья"
date: "2026-01-18"
output:
  officedown::rdocx_document:
    reference_docx: "example.docx"
    toc: true
    toc_depth: 8
toc-title: "Оглавление"
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
library(readr)
library(flextable)
library(survival)
library(knitr)
library(gtsummary)

set_flextable_defaults(table.layout = "autofit",
                       font.family = "Times New Roman")

flex_default_fun <- function(x) {
  x %>% 
  theme_box() %>%
  font(fontname = "Times New Roman", part = "all") %>% 
  fontsize(size = 13, part = "header") %>% 
  fontsize(size = 12, part = "body") %>% 
  flextable::align(
  i = 1,
  j = NULL,
  align = "center",
  part = "header")
}

statistics <- list(
        "N valid" = ~round(sum(!is.na(.)), 0),
        # "Пропущенные значения, n" = ~round(sum(is.na(.)), 2),
        "Среднее" = ~round(mean(., na.rm = TRUE), 2),
        "Стандартное отклонение"   = ~round(sd(., na.rm = TRUE), 2),
        "Медиана" = ~round(median(., na.rm = TRUE), 2),
        "Q1" = ~round(quantile(., 0.25, na.rm = TRUE), 2),
        "Q3" = ~round(quantile(., 0.75, na.rm = TRUE), 2),
        "IQR" = ~round(IQR(., na.rm = TRUE), 2),
        "Мин"  = ~round(min(., na.rm = TRUE), 2),
        "Макс"  = ~round(max(., na.rm = TRUE), 2)
      )

```


```{r read-data, message=FALSE}
data_raw <- read_csv("team5_ecrf_wide.csv")
```


``` {r data prep, echo=FALSE}
data_transformed <- data_raw %>%
  mutate(
    across(8:38, as.factor)
    )
data_long <- data_raw %>%
  pivot_longer(
    cols = matches("^V[0-9]+_"),
    names_to = "var",
    values_to = "value"
  ) %>%
  mutate(
    visit = str_extract(var, "^V[0-9]+"),
    varname = str_remove(var, "^V[0-9]+_")
  )

```

# Раздел 1.  Демографические, антроп. данные и исходные характеристики заболевания

## 1.1 Таблицы с демографическими характеристиками

``` {r summary baseline tables, echo=TRUE }
baseline_df <- data_raw %>%
  mutate(
    ARM = case_when(
      ARM == "Angelique" ~ "Анжелик",
      ARM == "Climaksan" ~ "Климаксан"
    ) %>% factor()
  ) %>%
  transmute(
    ID = USUBJID,
    "Группа лечения" = ARM,
    #демография и антропометрия
    "Пол" = if_else(V0_DEM_SEX == FALSE, "Женский", "Мужской"),
    "Возраст" = V0_DEM_AGE,
    "Рост, см" = V0_ANT_HEIGHTCM,
    "Вес, кг"  = V0_ANT_WEIGHTKG,
    "ИМТ, кг/м²" = V0_ANT_BMI,
    
    #Гормоны и опросники
    "Эстрадиол (E2)" = V0_HOR_E2,
    "Фолликулостимулирующий гормон (ФСГ)" = V0_HOR_FSH,
    "Шкала Грина (баллы)" = V0_SYM_GREENE,
    "SF-36 (баллы)"       = V0_QOL_SF36,
    "Приливы (кол-во)"    = V0_SYM_FLASHES,
    
    # Витальные показатели
    "Отклонение ЧСС"   = factor(V0_VIT_HR_ABN,   levels = c(0, 1), labels = c("Нет", "Да")),
    "Отклонение ЧДД"   = factor(V0_VIT_RR_ABN,   levels = c(0, 1), labels = c("Нет", "Да")),
    "Отклонение АД"    = factor(V0_VIT_BP_ABN,   levels = c(0, 1), labels = c("Нет", "Да")),
    "Отклонение температуры"  = factor(V0_VIT_TEMP_ABN, levels = c(0, 1), labels = c("Нет", "Да")),
    
    # ЭКГ
    "Нарушение ритма" = factor(V0_ECG_RHYTHM_ABN, levels = c(0, 1), labels = c("Нет", "Да")),
    "Изменения ST-T"  = factor(V0_ECG_STT_ABN,    levels = c(0, 1), labels = c("Нет", "Да")),
    "QT-аномалия"     = factor(V0_ECG_QT_ABN,     levels = c(0, 1), labels = c("Нет", "Да")),
    
    #Клинический анализ крови
    "Гемоглобин"   = V0_CBC_HGB,
    "Лейкоциты"   = V0_CBC_WBC,
    "Тромбоциты"   = V0_CBC_PLT,
    
    #Биохимия
    "Креатинин" = V0_BIO_CREAT,
    "АЛТ"   = V0_BIO_ALT,
    "АСТ"  = V0_BIO_AST,
    "Холестерин общий"  = V0_BIO_CHOL,
    "Гликированный гемоглобин (HbA1c)" = V0_BIO_HBA1C,
    
    # Общий анализ мочи 
    "Белок" = V0_URN_PROT,
    "Эритроциты" = V0_URN_RBC
  )


make_section_ft <- function(df, vars, title) {
  df %>%
    select(`Группа лечения`, all_of(vars)) %>%
    tbl_summary(
      by = `Группа лечения`,
      statistic = list(
        all_continuous() ~ "\n{mean} ± {sd}\n{median} [{p25}, {p75}]",
        all_categorical() ~ "{n} ({p}%)"
      ),
      digits = all_continuous() ~ 2,
      missing = "ifany"
    ) %>%
    add_p(
      test = list(
        all_continuous() ~ "t.test",      
        all_categorical() ~ "chisq.test"  
      )
    ) %>%
    modify_header(label ~ "**Показатель**") %>%
    modify_spanning_header(all_stat_cols() ~ "**Группа лечения**") %>%
    modify_caption(title) %>% 
    as_flex_table() %>% 
    autofit() %>%
    flextable::set_caption(caption = title)
}


baseline_table_1 <- make_section_ft (baseline_df, c( "Возраст", "Рост, см", "Вес, кг", "ИМТ, кг/м²"), "Таблица 1. Демография и антропометрия")
baseline_table_2 <- make_section_ft (baseline_df, c("Эстрадиол (E2)", "Фолликулостимулирующий гормон (ФСГ)", "Шкала Грина (баллы)", "SF-36 (баллы)", "Приливы (кол-во)"),
                       "Таблица 2. Гормоны, симптомы и качество жизни")
baseline_table_3 <- make_section_ft (baseline_df, c("Креатинин", "АЛТ", "АСТ", "Холестерин общий", "Гликированный гемоглобин (HbA1c)"), "Таблица 3. Биохимия крови")
baseline_table_4 <- make_section_ft (baseline_df, c("Белок", "Эритроциты"), "Таблица 4. Показатели мочи")
baseline_table_5 <- make_section_ft (baseline_df, c("Отклонение ЧСС", "Отклонение ЧДД", "Отклонение АД", "Отклонение температуры"), "Таблица 5. Витальные показатели")
baseline_table_6 <- make_section_ft (baseline_df, c("Нарушение ритма", "Изменения ST-T", "QT-аномалия"), "Таблица 6. ЭКГ")
baseline_table_7 <- make_section_ft (baseline_df, c("Гемоглобин", "Лейкоциты", "Тромбоциты"), "Таблица 7. Клинический анализ крови")
```


```{r print baseline tables, echo=FALSE}
baseline_table_1
baseline_table_2
baseline_table_3
baseline_table_4
baseline_table_5
baseline_table_6
baseline_table_7
```

## 1.2 Выводы

В исследование включено 576 пациенток в менопаузе с длительностью спонтанной аменореи не менее 12 месяцев и интактной маткой.  Пациентки были рандомизированы в две группы лечения: группа Анжелик (N=288) и группа Климаксан (N=288).

Исходно группы были сопоставимы по демографическим показателям и характеристикам заболевания.

Демографические показатели: средний возраст пациенток в группе Анжелик составил 52,29±4,18 года, в группе Климаксан – 52,13±4,35 года. Антропометрические показатели также были сопоставимы, в том числе, индекс массы тела (ИМТ), который соответствовал избыточной массы тела и составил 27,70±5,82 кг/м² в группе Анжелик и 27,41±5,48 кг/м² в группе Климаксан.

Исходные уровни половых гормонов соответствовали периоду менопаузы. Средний уровень эстрадиола составил 24,84±14,34 пг/мл в группе Анжелик и 25,25±15,12 пг/мл в группе Климаксан. Уровень фолликулостимулирующего гормона (ФСГ) был сопоставим между группами: 56,38±16,27 МЕ/л в группе Анжелик и 56,23±17,69 МЕ/л в группе Климаксан.

Что касается исходного уровня изучаемых параметров, частота умеренных и тяжелых приливов на исходном визите составила 9,23±3,97 приливов в сутки в группе Анжелик и 9,10±4,07 приливов в сутки в группе Климаксан. 

Выраженность климактерических симптомов по опроснику Green Scale на исходном визите составила 19,02±5,68 балла в группе Анжелик и 18,53±5,44 балла в группе Климаксан. 

Показатели качества жизни по опроснику SF-36 были сопоставимы между группами: 52,79±12,22 балла в группе Анжелик и 54,40±12,57 балла в группе Климаксан.

Таким образом, анализ демографических, гормональных и клинических показателей на исходном визите продемонстрировал сбалансированность групп, что  позволяет проводить корректное сравнение эффективности и безопасности исследуемых препаратов.

# Раздел 2. Отклонения от протокола  

В ходе исследования выявлены отклонения от протокола в виде несоответствия критериев включения по индексу массы тела и возрасту. Отклонения были признаны Спонсором некритичными и были поданы в локальные этические комитеты центров. По итогам совещания по обзору данных пациентки с отклонениями были включены в анализ. Таким образом, анализ как эффективности, так и безопасности производился в популяции ITT.

# Раздел 3. Анализ конечных точек

## 3.1 Анализ первичной конечной точки

Считаем уменьшение приливов к последнему визиту по сравнению с базовым уровнем.

```{r primary 1, TRUE=FALSE}
data_raw <- data_raw %>%
  mutate(delta_f = V0_SYM_FLASHES - V7_SYM_FLASHES)
```

### 3.1.1 Сводная таблица - описательные статистики уменьшения количества приливов к концу периода лечения (12 недель)

```{r primary 2, TRUE=FALSE}
data_raw <- data_raw %>% 
  mutate(ARM = ARM %>% as.factor() %>% forcats::fct_rev())

desc_stats <- data_raw %>%
  group_by(ARM) %>%
  summarise(
    n = sum(!is.na(delta_f)),
    mean_delta = mean(delta_f, na.rm = TRUE),
    sd_delta = sd(delta_f, na.rm = TRUE),
    se_delta = sd_delta / sqrt(n),
    ci_lower = mean_delta - qt(0.975, n-1) * se_delta,
    ci_upper = mean_delta + qt(0.975, n-1) * se_delta,
    median_delta = median(delta_f, na.rm = TRUE),
    min_delta = min(delta_f, na.rm = TRUE),
    max_delta = max(delta_f, na.rm = TRUE)
  ) %>% 
  mutate(n = n %>% round(0),
         across(c(where(is.numeric), -n), ~round(.x, 2)))

desc_stats %>% 
  flextable() %>%
  flex_default_fun()
```

### 3.1.2 Проведения одностороннего t-теста Уэлча и построение одностороннего ДИ для вывода о первичной конечной точке


```{r primary 2-123, echo=TRUE}
non_inferiority_margin <- -2  
alpha <- 0.025  
conf_level <- 1 - alpha  

# Правильные формулировки гипотез:
# H0: μ_T - μ_R ≤ -2 (Климаксан УСТУПАЕТ Анжелику)
# H1: μ_T - μ_R > -2 (Климаксан НЕ УСТУПАЕТ Анжелику)
t_test_noninf <- t.test(delta_f ~ ARM, 
                       data = data_raw,  
                       var.equal = FALSE,
                       conf.level = conf_level,  
                       alternative = "greater",  
                       mu = non_inferiority_margin)  

cat("\n=== Результаты t-теста для проверки не меньшей эффективности ===\n")
cat(sprintf("Граница не меньшей эффективности (дельта): %.2f\n", non_inferiority_margin))
cat(sprintf("Статистика t: %.3f\n", t_test_noninf$statistic))
cat(sprintf("Степени свободы: %.2f\n", t_test_noninf$parameter))
cat(sprintf("Одностороннее p-значение: %.4f\n", t_test_noninf$p.value))
cat(sprintf("97.5%% односторонний ДИ: [%.3f, Inf]\n", t_test_noninf$conf.int[1]))
cat(sprintf("Разность средних (Климаксан - Анжелик): %.3f\n", 
            -diff(t_test_noninf$estimate)))  

mean_diff <- -diff(t_test_noninf$estimate)
se_diff <- sqrt(sum(desc_stats$sd_delta^2 / desc_stats$n))
df_welch <- t_test_noninf$parameter
margin <- qt(1 - alpha, df_welch) * se_diff
ci_lower_noninf <- mean_diff - margin

cat(sprintf("\nТочная оценка разности: %.3f\n", mean_diff))
cat(sprintf("97.5%% односторонний ДИ (нижняя граница): %.3f\n", ci_lower_noninf))

cat("\n=== Вывод о не меньшей эффективности ===\n")
if (t_test_noninf$p.value < alpha && ci_lower_noninf > non_inferiority_margin) {
  cat("ОТВЕРГАЕМ H0: Климаксан НЕ УСТУПАЕТ Анжелику.\n")
  cat(sprintf("Нижняя граница 97.5%% ДИ (%.3f) > границы не меньшей эффективности (%.2f)\n", 
              ci_lower_noninf, non_inferiority_margin))
} else {
  cat("НЕ ОТВЕРГАЕМ H0: Не удалось доказать не меньшую эффективность Климаксана.\n")
  cat(sprintf("Нижняя граница 97.5%% ДИ (%.3f) ≤ границе не меньшей эффективности (%.2f)\n", 
              ci_lower_noninf, non_inferiority_margin))
}
```
3.1.2 Проведения двустороннего t-теста Уэлча и построение двустороннего ДИ для общего сравнения групп

```{r primary 3, echo=TRUE}
# cat("\n=== Двусторонний t-тест Уэлча для общего сравнения ===\n")
t_test_welch <- t.test(delta_f ~ ARM, 
                      data = data_raw,
                      var.equal = FALSE,
                      conf.level = 0.95)
t_test_welch %>% broom::tidy() %>% 
  mutate(p.value = p.value %>% gtsummary::style_pvalue()) %>%
  mutate(across(c(where(is.numeric), -p.value), ~round(.x, 2))) %>%
  mutate(across(everything(), ~as.character(.x))) %>% 
  select(-c(method, alternative)) %>% 
   rename(
    `Разница средних между гр. Климаксана и гр. Анжелика` = estimate,
    `Среднее в гр. Климаксана` = estimate1,
    `Среднее в гр. Анжелика` = estimate2,
    `t-статистика` = statistic,
    `Степени свободы` = parameter,
    `P-value` = p.value,
    `Нижн. гр. 95% ДИ` = conf.low,
    `Верхн. гр. 95% ДИ` = conf.high
  ) %>% 
  pivot_longer(everything(),
               names_to = "Параметр",
               values_to = "Значение") %>% 
  flextable() %>% 
  flex_default_fun() %>% 
  add_header_row(values = "Двусторонний t-тест Уэлча для общего сравнения",
                 colwidths = 2)
```

### 3.1.3 График изменения частоты приливов в группах лечения

```{r primary 4, echo=TRUE}
density_plot <- ggplot(data_raw, aes(x = delta_f)) +
  geom_histogram(aes(y = after_stat(density), fill = ARM), 
                 alpha = 0.5, position = "identity", bins = 30) +
  geom_density(alpha = 0.3, aes(fill = ARM)) +
  geom_vline(data = desc_stats, aes(xintercept = mean_delta, color = ARM),
             linetype = "dashed", linewidth = 1) +
  facet_wrap(~ARM, ncol = 1) +
  scale_fill_manual(values = c("Climaksan" = "blue", "Angelique" = "red"),
                    labels = c("Climaksan" = "Климаксан", "Angelique" = "Анжелик")) +
  scale_color_manual(values = c("Climaksan" = "darkblue", "Angelique" = "darkred"),
                    labels = c("Climaksan" = "Климаксан", "Angelique" = "Анжелик")) +
  labs(title = "Распределение изменений частоты приливов",
       x = "Изменение частоты приливов (приливы/сутки)",
       y = "Плотность распределения",
       color = "Терапия",
       fill = "Терапия",
       caption = "Пунктирная линия = среднее значение") +
  theme_minimal() +
  theme(strip.text.x = element_blank())

print(density_plot)
```
### 3.1.4 График ДИ для конечной точки исследования

```{r primary 5, message=FALSE, fig.height=5, fig.width=8, dpi=300}
# Подготовка данных для графика
plot_data <- data.frame(
  Comparison = "Климаксан vs Анжелик",
  Estimate = -3.236,
  CI_lower = -3.663,
  CI_upper = -2.809,
  Margin = -2,
  p_value = 1.000
)

# Создание графика
forest_plot <- ggplot(plot_data, aes(x = Estimate, y = Comparison)) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
  geom_vline(xintercept = -2, linetype = "solid", color = "red", size = 1) +
  geom_point(size = 4, color = "blue") +
  geom_errorbarh(aes(xmin = CI_lower, xmax = CI_upper), 
                 height = 0.1, size = 1, color = "blue") +
  geom_rect(aes(xmin = -Inf, xmax = -2, ymin = -Inf, ymax = Inf),
            fill = "red", alpha = 0.05) +
  annotate("text", x = -2, y = 1.2, 
           label = "Граница не меньшей эффективности\n(-2 прилива/сутки)",
           hjust = 0.5, vjust = 0, color = "red", fontface = "bold") +
  annotate("text", x = -3.236, y = 0.7, 
           label = sprintf("Разность средних: %.3f\n95%% ДИ: [%.3f; %.3f]\nP = %.4f", 
                          -3.236, -3.663, -2.809, 1.000),
           hjust = 0.5, vjust = 0.5, color = "black") +
  scale_x_continuous(breaks = seq(-5, 1, 0.5),
                     limits = c(-5, 1),
                     name = "Разность средних (Климаксан - Анжелик)\nприливы/сутки") +
  labs(title = "Анализ не меньшей эффективности",
       subtitle = "Первичная конечная точка: изменение частоты приливов",
       y = "") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    axis.title.x = element_text(size = 11, face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank()
  )

print(forest_plot)
```

### 3.1.5 Выводы



## Раздел 3.2 Анализ вторичных конечных точек эффективности клинического исследования

### 3.2.1 Подготовка данных и библиотек

```{r readr-second-endpoints}
# ITT-популяция, все пациенты
data <- read.csv("team5_ecrf_wide.csv", stringsAsFactors = TRUE)

data$ARM <- factor(data$ARM, levels = c("Angelique", "Climaksan"))

table(data$ARM)
 
# Проверка структуры данных
head(data[c("USUBJID","ARM","V0_SYM_FLASHES","V3_SYM_FLASHES","V7_SYM_FLASHES",
            "V0_SYM_GREENE","V3_SYM_GREENE","V7_SYM_GREENE",
            "V0_QOL_SF36","V3_QOL_SF36","V7_QOL_SF36")])
```

В данных используются обозначения визитов V0 (день 0, визит 1, базовый уровень), V3 (день 30, визит 3) и V7 (день 90, визит 7) и т.д. для соответствующих дней исследования.

Все анализы проводятся на ITT-популяции (все 100% рандомизированных пациентов, так как выбывших не было). Во всех тестах принят уровень значимости p \< 0.05.

### 3.2.2. Доля случаев \>=50% снижения частоты умеренных/тяжёлых приливов

На визите 3 (день 30) и визите 7 (день 90). Для каждого пациента создадим индикатор достижения снижения частоты приливов на \>=50% по сравнению с исходным уровнем и сравним доли между группами с помощью χ²-теста. Также рассчитаем отношение шансов с 95% доверительным интервалом.

```{r}

data$success50_day30 <- ifelse(data$V3_SYM_FLASHES <= 0.5 * data$V0_SYM_FLASHES, 1, 0)
data$success50_day90 <- ifelse(data$V7_SYM_FLASHES <= 0.5 * data$V0_SYM_FLASHES, 1, 0)
 
data$success50_day30 <- factor(data$success50_day30, levels = c(0,1), labels = c("No","Yes"))
data$success50_day90 <- factor(data$success50_day90, levels = c(0,1), labels = c("No","Yes"))

tab30 <- table(Group = data$ARM, "≥50% reduction Day30" = data$success50_day30)
tab90 <- table(Group = data$ARM, "≥50% reduction Day90" = data$success50_day90)
tab30; tab90  

chi30 <- chisq.test(tab30)   
chi90 <- chisq.test(tab90)   

chi30$p.value   
chi90$p.value   

model30 <- glm(success50_day30 ~ ARM, data = data, family = binomial)
model90 <- glm(success50_day90 ~ ARM, data = data, family = binomial)

OR_day30 <- exp(coef(model30)[2])  # OR на день 30 (Климаксан относительно Анжелик)
OR_day90 <- exp(coef(model90)[2])  # OR на день 90

OR_day30_CI <- exp(confint.default(model30)[2, ])  
OR_day90_CI <- exp(confint.default(model90)[2, ])   

cat(sprintf("Day 30: OR = %.2f, 95%% CI [%.2f; %.2f], p = %.4f\n",
            OR_day30, OR_day30_CI[1], OR_day30_CI[2], chi30$p.value))
cat(sprintf("Day 90: OR = %.2f, 95%% CI [%.2f; %.2f], p = %.4f\n",
            OR_day90, OR_day90_CI[1], OR_day90_CI[2], chi90$p.value))
```

Описательная статистика по доле достигших \>=50% снижение: сформируем таблицу с численностью и процентом пациентов, достигших эффекта, в каждой группе на 30-й и 90-й день.

```{r}
 
prop_stats <- data %>% group_by(ARM) %>%
  summarise(
    N = n(),
    n_success30 = sum(success50_day30 == "Yes"),
    perc_success30 = 100 * mean(success50_day30 == "Yes"),
    n_success90 = sum(success50_day90 == "Yes"),
    perc_success90 = 100 * mean(success50_day90 == "Yes")
  )

prop_stats <- prop_stats %>%
  mutate(
    Day30 = sprintf("%d (%.1f%%)", n_success30, perc_success30),
    Day90 = sprintf("%d (%.1f%%)", n_success90, perc_success90)
  ) %>%
  select(Группа = ARM, N, "≥50% снижение (День 30)" = Day30, "≥50% снижение (День 90)" = Day90)

ft_prop <- flextable(prop_stats)
ft_prop <- autofit(ft_prop)
ft_prop
```

### 3.2.3. Снижение суммы баллов по шкале Greene Climacteric Scale

На визите 3 (день 30) и визите 7 (день 90). Рассчитаем изменение общего балла шкалы Greene от исходного уровня (визит 1) до визитов 3 и 7. Сравнение изменений между группами проводим с помощью t-теста Уэлча (независимые выборки, дисперсии могут различаться). Статистическую значимость оцениваем при p \< 0.05.

```{r}
# (базовый балл минус балл на визите)  положительное значение означает снижение симптоматики
data$greene_change_30 <- data$V0_SYM_GREENE - data$V3_SYM_GREENE    
data$greene_change_90 <- data$V0_SYM_GREENE - data$V7_SYM_GREENE    

greene_stats <- data %>% group_by(ARM) %>%
  summarise(
    N = n(),
    mean_change30 = mean(greene_change_30, na.rm = TRUE),
    sd_change30   = sd(greene_change_30, na.rm = TRUE),
    mean_change90 = mean(greene_change_90, na.rm = TRUE),
    sd_change90   = sd(greene_change_90, na.rm = TRUE)
  )

greene_stats <- greene_stats %>%
  mutate(
    se_change30 = sd_change30 / sqrt(N),
    ci_lower30 = mean_change30 - 1.96 * se_change30,
    ci_upper30 = mean_change30 + 1.96 * se_change30,
    se_change90 = sd_change90 / sqrt(N),
    ci_lower90 = mean_change90 - 1.96 * se_change90,
    ci_upper90 = mean_change90 + 1.96 * se_change90
  )

greene_stats <- greene_stats %>%
  mutate(
    `Изм. Greene (день 30) mean±SD` = sprintf("%.2f ± %.2f", mean_change30, sd_change30),
    `95% ДИ (день 30)` = sprintf("[%.2f; %.2f]", ci_lower30, ci_upper30),
    `Изм. Greene (день 90) mean±SD` = sprintf("%.2f ± %.2f", mean_change90, sd_change90),
    `95% ДИ (день 90)` = sprintf("[%.2f; %.2f]", ci_lower90, ci_upper90)
  ) %>%
  select(Группа = ARM, N,
         `Изм. Greene (день 30) mean±SD`,
         `95% ДИ (день 30)`,
         `Изм. Greene (день 90) mean±SD`,
         `95% ДИ (день 90)`)

ft_greene <- flextable(greene_stats)
ft_greene <- autofit(ft_greene)
ft_greene
```

Теперь проведём t-тесты для сравнения изменений между группами:

```{r}

t_green30 <- t.test(greene_change_30 ~ ARM, data = data, var.equal = FALSE)
t_green90 <- t.test(greene_change_90 ~ ARM, data = data, var.equal = FALSE)

# День 30
t_green30
format.pval(t_green30$p.value, digits = 3, eps = 1e-16)

data %>%
  group_by(ARM) %>%
  summarise(
    n = sum(!is.na(greene_change_30)),
    mean = mean(greene_change_30, na.rm = TRUE),
    sd = sd(greene_change_30, na.rm = TRUE),
    .groups = "drop"
  )

m30_clim <- mean(data$greene_change_30[data$ARM == "Climaksan"], na.rm = TRUE)
m30_ang  <- mean(data$greene_change_30[data$ARM == "Angelique"], na.rm = TRUE)
sd30_clim <- sd(data$greene_change_30[data$ARM == "Climaksan"], na.rm = TRUE)
sd30_ang  <- sd(data$greene_change_30[data$ARM == "Angelique"], na.rm = TRUE)

cat(sprintf(
  "Изменение балла Greene к дню 30: p = %s (Климаксан: %.2f±%.2f, Анжелик: %.2f±%.2f)\n",
  format.pval(t_green30$p.value, digits = 3, eps = 1e-16),
  m30_clim, sd30_clim, m30_ang, sd30_ang
))

# День 90 
t_green90
format.pval(t_green90$p.value, digits = 3, eps = 1e-16)

data %>%
  group_by(ARM) %>%
  summarise(
    n = sum(!is.na(greene_change_90)),
    mean = mean(greene_change_90, na.rm = TRUE),
    sd = sd(greene_change_90, na.rm = TRUE),
    .groups = "drop"
  )

m90_clim <- mean(data$greene_change_90[data$ARM == "Climaksan"], na.rm = TRUE)
m90_ang  <- mean(data$greene_change_90[data$ARM == "Angelique"], na.rm = TRUE)
sd90_clim <- sd(data$greene_change_90[data$ARM == "Climaksan"], na.rm = TRUE)
sd90_ang  <- sd(data$greene_change_90[data$ARM == "Angelique"], na.rm = TRUE)

cat(sprintf(
  "Изменение балла Greene к дню 90: p = %s (Климаксан: %.2f±%.2f, Анжелик: %.2f±%.2f)\n",
  format.pval(t_green90$p.value, digits = 3, eps = 1e-16),
  m90_clim, sd90_clim, m90_ang, sd90_ang
))

```

### 3.2.4. Время до снижения количества приливов на 2 в сутки

Для оценки периода, необходимого для снижения числа приливов на 2 в день (по данным дневников), используем анализ времени до события. Событие определяем как первое появление значения "число приливов в сутки" на 2 меньше исходного уровня. Все пациенты, не достигшие снижения \>=2 приливов, цензурируются на последнем визите наблюдения (90 дней).

Применим метод Каплана-Мейера для построения кривых **времени до события** в каждой группе и логранговый тест для сравнения кривых.

```{r}

data$time_reduce2 <- NA  # время наступления события или цензуры
data$event_reduce2 <- 0  

# время события для каждого пациента
for(i in 1:nrow(data)) {
  bl <- data$V0_SYM_FLASHES[i]
  if (!is.na(bl)) {
    if (data$V2_SYM_FLASHES[i] <= bl - 2) {
      data$time_reduce2[i] <- 15
      data$event_reduce2[i] <- 1
    } else if (data$V3_SYM_FLASHES[i] <= bl - 2) {
      data$time_reduce2[i] <- 30
      data$event_reduce2[i] <- 1
    } else if (data$V4_SYM_FLASHES[i] <= bl - 2) {
      data$time_reduce2[i] <- 45
      data$event_reduce2[i] <- 1
    } else if (data$V5_SYM_FLASHES[i] <= bl - 2) {
      data$time_reduce2[i] <- 60
      data$event_reduce2[i] <- 1
    } else if (data$V6_SYM_FLASHES[i] <= bl - 2) {
      data$time_reduce2[i] <- 75
      data$event_reduce2[i] <- 1
    } else if (data$V7_SYM_FLASHES[i] <= bl - 2) {
      data$time_reduce2[i] <- 90
      data$event_reduce2[i] <- 1
    } else {
      # событие не произошло к 90 дню: цензурируем на 90 день
      data$time_reduce2[i] <- 90
      data$event_reduce2[i] <- 0
    }
  }
}

table(data$event_reduce2, data$ARM)  # распределение событий/цензуры по группам

# Анализ Каплана-Мейера
surv_obj <- Surv(time = data$time_reduce2, event = data$event_reduce2)
km_fit <- survfit(surv_obj ~ ARM, data = data)
print(km_fit)

# Логранговый тест для сравнения кривых выживания 
logrank_test <- survdiff(surv_obj ~ ARM, data = data)
logrank_test$chisq   
p_logrank <- 1 - pchisq(logrank_test$chisq, df = 1)  
p_logrank
cat(sprintf("Логранговый тест: χ² = %.2f, p = %.2e\n", logrank_test$chisq, p_logrank))

#  медиана времени до события в каждой группе (если >50% пациентов достигли событие)
medians <- quantile(km_fit, probs = 0.5)
medians

plot(km_fit, col=c("blue","red"), lty=1:2, xlab="Дни", ylab="Доля без снижения приливов на 2",
     main="Время до снижения количества приливов на 2 в сутки")
legend("bottomleft", legend = levels(data$ARM), col=c("blue","red"), lty=1:2)

```

На графике выше по оси y отложена доля пациентов, не достигших снижения количества приливов на 2. Кривые Каплана-Мейера показывают вероятность того, что событие ещё не произошло в зависимости от времени. Заметное расхождение кривых и полученное p-значение логрангового теста указывают на различие между группами.

### 3.2.5. Увеличение суммы баллов по шкале SF-36

На визите 3 (день 30) и визите 7 (день 90). Рассчитаем изменение общего балла SF-36 от исходного уровня: положительное изменение означает улучшение качества жизни. Сравним средние улучшения между группами с помощью t-теста Уэлча.

```{r}
 
data$sf36_change_30 <- data$V3_QOL_SF36 - data$V0_QOL_SF36   # изменение к дню 30 (увеличение)
data$sf36_change_90 <- data$V7_QOL_SF36 - data$V0_QOL_SF36   # изменение к дню 90

sf36_stats_raw <- data %>% 
  group_by(ARM) %>%
  summarise(
    N = sum(!is.na(sf36_change_30)),
    mean_change30 = mean(sf36_change_30, na.rm = TRUE),
    sd_change30   = sd(sf36_change_30, na.rm = TRUE),
    mean_change90 = mean(sf36_change_90, na.rm = TRUE),
    sd_change90   = sd(sf36_change_90, na.rm = TRUE),
    .groups = "drop"
  )

sf36_stats <- sf36_stats_raw %>%
  mutate(
    se_change30 = sd_change30 / sqrt(N),
    ci_lower30 = mean_change30 - 1.96 * se_change30,
    ci_upper30 = mean_change30 + 1.96 * se_change30,
    se_change90 = sd_change90 / sqrt(N),
    ci_lower90 = mean_change90 - 1.96 * se_change90,
    ci_upper90 = mean_change90 + 1.96 * se_change90
  ) %>%
  mutate(
    `Изм. SF-36 (день 30) mean±SD` = sprintf("%.2f ± %.2f", mean_change30, sd_change30),
    `95% ДИ (день 30)` = sprintf("[%.2f; %.2f]", ci_lower30, ci_upper30),
    `Изм. SF-36 (день 90) mean±SD` = sprintf("%.2f ± %.2f", mean_change90, sd_change90),
    `95% ДИ (день 90)` = sprintf("[%.2f; %.2f]", ci_lower90, ci_upper90)
  ) %>%
  select(Группа = ARM, N,
         `Изм. SF-36 (день 30) mean±SD`, `95% ДИ (день 30)`,
         `Изм. SF-36 (день 90) mean±SD`, `95% ДИ (день 90)`)

ft_sf36 <- flextable(sf36_stats)
ft_sf36 <- autofit(ft_sf36)
ft_sf36

t_sf30 <- t.test(sf36_change_30 ~ ARM, data = data, var.equal = FALSE)
t_sf90 <- t.test(sf36_change_90 ~ ARM, data = data, var.equal = FALSE)

t_sf30$p.value
t_sf90$p.value

m_clim <- sf36_stats_raw$mean_change30[sf36_stats_raw$ARM == "Climaksan"]
sd_clim <- sf36_stats_raw$sd_change30[sf36_stats_raw$ARM == "Climaksan"]
m_ang  <- sf36_stats_raw$mean_change30[sf36_stats_raw$ARM == "Angelique"]
sd_ang <- sf36_stats_raw$sd_change30[sf36_stats_raw$ARM == "Angelique"]

cat(sprintf(
  "Увеличение SF-36 к дню 30: p = %s (Климаксан: %.1f±%.1f, Анжелик: %.1f±%.1f)\n",
  format.pval(t_sf30$p.value, digits = 3, eps = 1e-16),
  m_clim, sd_clim, m_ang, sd_ang
))

```

### 3.2.6 Выводы

Проведен анализ эффективности по вторичным конечным точкам.

#### 3.2.6.1 Снижение частоты умеренных/тяжелых приливов

Для оценки доли случаев, в которых достигнуто снижение частоты умеренных / тяжелых приливов на 50% и более по сравнению с исходным уровнем на визите 3 (4 недели) и визите 7 (12 недель) для каждой пациентки был рассчитан % снижения частоты приливов относительно исходного уровня (визит 0). Пациентки были разделены на тех, кто достиг снижения частоты умеренных / тяжелых приливов на ≥50% и не достиг. Сравнение долей пациентов между группами проводилось с использованием критерия хи-квадрат (χ²). Для оценки величины эффекта было рассчитано отношение шансов (Odds Ratio, OR) с 95% ДИ.

На 30 день терапии в группе Анжелик из 288 пациенток клинически значимое снижение частоты приливов (≥50%) было достигнуто у 61 пациентки (21,2%). В группе Климаксан из 288 пациентов аналогичное улучшение наблюдалось у 29 пациенток (10,1%). Анализ выявил статистически достоверное различие между группами (χ²=12,89, p=0,0004), OR 0,42 (95% ДИ [0,26; 0,67], что свидетельствует о преимуществе препарата Анжелик в достижении клинически значимого улучшения к 30-му дню терапии.

К концу основного периода (90-й день) в группе Анжелик доля пациенток, достигших снижения частоты приливов на ≥50% составила 132 (45,8%). В группе Климаксан данный показатель составил 23 пациентки (8,0%). Анализ выявил статистически достоверное различие между группами (χ²=115,64, p<0,0001), OR 0,10 (95% ДИ [0,06–0,17], что также свидетельствует о преимуществе препарата Анжелик в отношении контроля вазомоторных симптомов менопаузы.


#### 3.2.6.2 Оценка снижения общей выраженности климактерических симптомов по суммарному баллу опросника Greene Climacteric Scale (GCS) 

Для оценки влияния терапии на общую выраженность климактерических симптомов использовалась валидированная шкала Greene Climacteric Scale (GCS). Анализ проводился на 30-й день (визит 3) и 90-й день (визит 7) терапии путем сравнения изменения общего балла GCS от исходного уровня (визит 1) между группами. Сравнение групп выполнялось с использованием t-теста. 

На 30 день в группе Анжелик среднее снижение общего балла GCS составило 3,16 балла (SD=2,62) с 95% ДИ [2,86; 3,47]. В группе Климаксан среднее изменение балла составило 0,05 балла (SD=2,51) с 95% ДИ [-0,24; 0,34], различия между группами были статистически достоверны (p < 0,0001). 

К концу основного периода в группе Анжелик зафиксировано среднее снижение общего балла GCS на 6,22 балла (SD=2,45) с 95% ДИ [5,94; 6,51]. В группе Климаксан изменение балла составило 0,03 балла (SD=2,56) с 95% ДИ [-0,26; 0,33], различия между группами были статистически достоверны (p < 0,0001). 

Полученные результаты демонстрируют статистически значимое и клинически выраженное превосходство препарата Анжелик над препаратом Климаксан в снижении общей выраженности климактерических симптомов, оцениваемой по шкале GCS. 

#### 3.2.6.3 Оценка периода времени, потребовавшегося для снижения количества приливов хотя бы на 2 в сутки по данным дневника пациентки.

Был проведен анализ времени до достижения клинически значимого снижения частоты приливов, определяемого как уменьшение количества умеренных и тяжелых вазомоторных симптомов на ≥2 в сутки по сравнению с исходным уровнем (визит 0). Событием считалось первое наблюдение снижения частоты приливов ≥2 в сутки из последующих визитов (дни 15, 30, 45, 60, 75, 90). Пациенты, не достигшие указанного снижения к концу периода наблюдения (90 дней), были цензурированы на момент последнего визита.

Для визуализации и сравнения временных профилей терапевтического ответа между группами использовался метод Каплана-Мейера. Статистическая значимость различий между группами оценивалась с помощью логрангового теста (Log-rank test).

В группе Анжелик из 288 пациентов клинически значимое снижение частоты приливов (≥2 в сутки) было достигнуто у 287 пациентов (99,7%). Медиана времени до достижения события составила 30 дней (95% ДИ: 15–30 дней). В группе Климаксан аналогичное снижение было достигнуто у 256 пациентов из 288 (88,9%), медиана времени до события составила 30 дней (95% ДИ: 30–45 дней).

Количество цензурированных пациенток на момент последнего визита основного периода составило 1 в группе Климаксана и 0 в группе Анжелик.
Логранговый тест выявил статистически значимое различие между кривыми выживаемости групп (χ²=78,82, p<0,0001). Анализ кривых Каплана-Мейера демонстрирует более раннее достижение клинически значимого снижения в группе Анжелик по сравнению с группой Климаксан.

#### 3.2.6.4 Оценка влияния терапии на качество жизни по опроснику  SF-36 на визитах лечения по сравнению с визитом 1

Для оценки влияния терапии на качество жизни пациенток использовался SF-36. Анализ проводился на двух временных точках: 30-й день (визит 3) и 90-й день (визит 7) терапии. Рассчитывалось изменение общего балла SF-36 относительно исходного уровня, при этом положительные значения изменения свидетельствуют об улучшении качества жизни. Сравнение средних изменений между группами лечения выполнялось с использованием t-теста Уэлча для независимых выборок.

На 30 день терапии в группе Анжелик среднее увеличение общего балла SF-36 к 30-му дню терапии составило +4,58 балла (SD=6,75) с 95% ДИ [3,80; 5,36], что свидетельствует о статистически значимом и клинически значимом улучшении качества жизни. В группе Климаксан изменение балла было минимальным и статистически незначимым: +0,07 балла (SD=6,54) с 95% ДИ [-0,68; 0,83].

К концу основного периода в группе Анжелик среднее увеличение балла SF-36 достигло +8,32 балла (SD=6,11) с 95% ДИ [7,62; 9,03]. В группе Климаксан -0,32 балла, SD=6,70; 95% ДИ: [-1,10; 0,45]). 
Различия между группами терапии на 30 и 90 дне были статистически достоверны (р<0,0001).


# Раздел 4. Анализ безопасности

```{r AE-df}
not_ADAE <- data_raw %>% 
  select(USUBJID, ARM, contains("_ABN")) %>% 
  mutate(ARM = ARM %>% as.factor()) %>% 
  rename_with(~str_remove(.x, "_ABN"), contains("_ABN")) %>% 
  pivot_longer(!c(USUBJID, ARM),
               names_to = c("AVISIT", "DOMAIN", "PARAM"),
               names_sep = "_",
               names_transform = list(AVISIT = as.factor,
                                      DOMAIN = as.factor,
                                      PARAM = as.factor),
               values_to = "AVAL", 
               values_transform = list(AVAL = as.logical)) %>% 
  rename(TRTA = ARM) %>% 
  filter(AVISIT != "V0")
```

## 4.1 Анализ связи типа нежелательного явления и терапии

```{r}
any_AE <- not_ADAE %>% 
  group_by(USUBJID, TRTA, PARAM) %>% 
  summarise(AVAL = any(AVAL == TRUE)) %>% 
  ungroup()
```

```{r chi-sq-table-wide, eval=FALSE, echo=FALSE}
# {any_AE %>%
#   mutate(TRTA = case_when(TRTA == "Angelique" ~ "Анжелик",
#                           TRTA == "Climaksan" ~ "Климаксан") %>% as.factor,
#          PARAM = case_when(PARAM == "BP" ~ "Артериальное давление",
#                            PARAM == "HR" ~ "ЧСС",
#                            PARAM == "RR" ~ "ЧДД",
#                            PARAM == "TEMP" ~ "Температура",
#                            PARAM == "RHYTHM" ~ "Сердечный ритм",
#                            PARAM == "STT" ~ "Сегменты ST-T",
#                            PARAM == "QT" ~ "Интервал QT") %>% as.factor(),
#          AVAL = case_when(AVAL == TRUE ~ "Да",
#                           AVAL == FALSE ~ "Нет") %>% as.factor()) %>% 
#   select(-USUBJID) %>%
#   rename("Терапия" = TRTA) %>% 
#   tbl_strata(strata = PARAM, .tbl_fun = ~.x %>% 
#                tbl_summary(by = AVAL,
#                            statistic = c(all_categorical() ~ "{n} ({p})"),
#                            digits = c(all_categorical() ~ c(2,2))
#                            ) %>%
#                add_p(test = list(all_categorical() ~ "chisq.test"),
#                      test.args = list(correct = TRUE))  %>%
#                modify_footnote(
#                  p.value ~ "χ2 с поправкой Йейтса"
#                  ) %>%
#                modify_header(label ~ "Группа")) %>% 
#   as_flex_table() %>% 
#   flex_default_fun()} %>% 
#   add_header_row(values =  "Наличие клинически значимых отклонений по типам показателей и терапии", colwidths = length(.$col_keys))
```

```{r chi-sq-tb-long}
table_final_chi_sq <-
  {any_AE %>%
  mutate(
    TRTA = case_when(
      TRTA == "Angelique" ~ "Анжелик",
      TRTA == "Climaksan" ~ "Климаксан"
    ) %>% factor(),
    PARAM = case_when(
      PARAM == "BP" ~ "Артериальное давление",
      PARAM == "HR" ~ "ЧСС",
      PARAM == "RR" ~ "ЧДД",
      PARAM == "TEMP" ~ "Температура",
      PARAM == "RHYTHM" ~ "Сердечный ритм",
      PARAM == "STT" ~ "Сегменты ST-T",
      PARAM == "QT" ~ "Интервал QT",
    ) %>% factor(),
    AVAL = case_when(AVAL == TRUE ~ "Да",
                     AVAL == FALSE ~ "Нет") %>% factor()
  ) %>%
    pivot_wider(names_from = PARAM, values_from = AVAL) %>%
    rename("Терапия" = TRTA) %>%
    select(-USUBJID) %>%
    tbl_summary(
    by = `Терапия`,
    statistic = all_categorical() ~ "{n} ({p}%)",
    digits = all_categorical() ~ 1
      ) %>%
    add_p(
    test = all_categorical() ~ "chisq.test",
    test.args = all_tests("chisq.test") ~ list(correct = TRUE)
      ) %>%
    modify_header(label ~ "Параметр / Группа") %>%
    modify_footnote(p.value ~ "χ2 с поправкой Йейтса") %>%
    bold_labels() %>% 
  as_flex_table() %>% 
  flex_default_fun()} %>% 
  add_header_row(values =  "Наличие клинически значимых отклонений по типам показателей и терапии", colwidths = length(.$col_keys))
```

\newpage
**Сводная таблица по типам НЯ в зависимости от группы терапии**

```{r AE-type-table, echo=FALSE}
table_final_chi_sq
```

## 4.2 Анализ количества НЯ по типу терапии

Используем регрессию Пуассона для частотных данных.

Формула модели:

$N_events ~ Pois(λ_x)$

$log(E(N_events | Treatment)) = log(λ_x)$

$var(N_events | Treatment) = λ_x$

$log(λ_x) = b_0 + b_1 × Treatment$

Допущения: 

    1) Независимость наблюдений;
    
    2) Отсутствие сверхдисперсии (проверяется далее);
    
    3) Отсутствие коллинеарности предикторов (у нас один предиктор, неприменимо).

```{r mod-pois}
poisson_df <- not_ADAE %>% 
  group_by(USUBJID, TRTA) %>% 
  summarise(AVAL_num = sum(AVAL, na.rm = TRUE)) %>% 
  ungroup()

glm_AE <- glm(AVAL_num ~ TRTA,
              data = poisson_df,
              family = "poisson")
```
**Проверка модели на сверхдисперсию**

```{r pois-overdisp}
# Функция для проверки наличия сверхдисперсии в модели (автор Ben Bolker)
# http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html
# Код модифицирован, чтобы учесть дополнительный параметр в NegBin GLMM, 
# подобранных MASS::glm.nb()
overdisp_fun <- function(model) {
  rdf <- df.residual(model)  # Число степеней свободы N - p
  if (any(class(model) == 'negbin')) rdf <- rdf - 1 ## учитываем k в NegBin GLMM
  rp <- residuals(model,type='pearson') # Пирсоновские остатки
  Pearson.chisq <- sum(rp^2) # Сумма квадратов остатков, подчиняется Хи-квадрат распределению 
  prat <- Pearson.chisq/rdf  # Отношение суммы квадратов остатков к числу степеней свободы
  pval <- pchisq(Pearson.chisq, df=rdf, lower.tail=FALSE) # Уровень значимости
  c(chisq=Pearson.chisq,ratio=prat,rdf=rdf,p=pval)        # Вывод результатов
}
{overdisp_fun(glm_AE)} %>% 
  tibble("Names" = names(.)) %>% 
  rename("Values" = ".") %>% 
  pivot_wider(names_from = Names, values_from = Values) %>% 
  mutate(across(c(where(is.numeric), -rdf), ~round(.x, 2))) %>% 
  rename("χ2" = chisq,
         "Отношение дисперсий" = ratio,
         "N степеней свободы" = rdf,
         "P-value" = p) %>% 
  flextable() %>% 
  flex_default_fun() %>% 
  add_header_row(values = "Результаты теста на сверхдисперсию", colwidth = 4)
```

Признаков сверхдисперсии не выявлено; в связи с этим переход к квази-пуассоновским или негативно биноминальным моделям не потребовался.

**Сводная таблица результатов анализа общей частоты нежелательных явлений в группах терапии с помощью регрессии Пуассона**

```{r pois-res}
{glm_AE %>% broom::tidy(exponentiate = TRUE,
                       conf.int = TRUE) %>%
     mutate(p.value = p.value %>%  gtsummary::style_pvalue(),
            across(c(where(is.numeric), - p.value), ~round(.x, 2))) %>% 
  slice_tail(n = 1) %>% 
  mutate(term = "Отношение частоты НЯ (IRR)") %>%
  select(-statistic) %>% 
  rename(
    `Показатель` = term,
    `Коэффициент (β)` = estimate,
    `Стандартная ошибка` = std.error,
    `P-value` = p.value,
    `Нижн. гр. 95% ДИ` = conf.low,
    `Верхн. гр. 95% ДИ` = conf.high
    ) %>% 
  flextable()} %>% 
  add_header_row(., values = "Отношение частоты НЯ в гр. терапии Климаксаном по сравнению с гр. терапии Анжеликом", colwidth = length(.$col_keys)) %>% 
  flex_default_fun()
```

## 4.3 Выводы 

    1) Не обнаружено значимой ассоциации НЯ различных типов с терапией (тесты χ2 с поправкой Йейтса).

    2) По результатам анализа регрессионной модели нахождению коэффициента и 95%ДИ с помощью теста Вальда для показателя терапии, отношение частоты событий (IRR) при терапии Климаксаном по отношению к группе Анжеликом составляет 0.96 (95%ДИ [0.89 ; 1.04]), p-значение теста коэффициента составило 0.3. Данный 95%ДИ накрывает 1 и $p-value > 0.05$, следовательно, частота НЯ в группах различается не значимо.

# Раздел 5. Заключение

Результаты проведенного рандомизированного клинического исследования не продемонстрировали не меньшую эффективность препарата Климаксан по сравнению с препаратом Анжелик в отношении улучшения климактерических симптомов как по первичной конечной точке (уменьшение количества приливов с границей не меньшей эффективности -2 на 12 неделе), так и по вторичным конечным точкам, которые включали также оценку тяжести климактерического синдрома по опроснику Green Scale и оценку качества жизни по опроснику  SF-36. 
В то же время, анализ данных безопасности показал сопоставимый профиль нежелательных явлений в обеих группах лечения, частота которых не отличалась в группах. В целом, продемонстрирован приемлемый профиль безопасности обоих исследуемых препаратов.